(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[42],{p9bT:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var i=n("vJKn"),o=n.n(i),a=n("rg98"),r=n("xEHj"),l=n("cpVT"),s=n("dhJC"),c=n("q1tI"),d=n.n(c),u=n("vcXL"),p=n.n(u),m=n("Aiso"),f=n.n(m),g=n("wTIg"),h=Object(g.a)("section",{target:"e143pbln0"})(".content{position:relative;display:flex;flex-direction:column;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{display:block;}> div{flex:1;}.mapbox-spinner-container{height:437px;flex:1;justify-content:center;align-items:center;display:flex;background-color:",(function(e){return e.theme.colors.paperGrey}),"99;position:absolute;z-index:10;width:100%;height:100%;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{height:100%;width:100%;margin-bottom:16px;}}}.filters{button.selected{border-bottom:2px solid ",(function(e){return e.theme.colors.primary}),";color:",(function(e){return e.theme.colors.primary}),";}}.map-container{position:relative;overflow:hidden;*{font-family:MuseoSansCyrl,Helvetica Neue,Roboto,sans-serif;}.travel-mode-selector{position:absolute;bottom:0;left:0;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{bottom:unset;top:0;}}}.mobile-marker-list{button{overflow:hidden;margin-bottom:8px;border:1px solid ",(function(e){return e.theme.colors.headerGrey}),";&:hover{}&.selected *{color:",(function(e){return e.theme.colors.white}),";span:last-of-type{color:",(function(e){return e.theme.colors.white}),";}}}}.list{background:transparent;max-width:300px;padding:16px;position:absolute;top:0;right:-15px;z-index:5;max-height:100%;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{position:relative;}overflow:hidden;overflow-y:auto;box-sizing:border-box;> button{overflow:hidden;margin-bottom:8px;box-shadow:0 0 6px 0px rgba(0,0,0,0.1);&:hover{}&.selected *{color:",(function(e){return e.theme.colors.white}),";span:last-of-type{color:",(function(e){return e.theme.colors.white}),";}}span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;span{line-height:20px !important;&:last-of-type{color:",(function(e){return e.theme.colors.midGrey}),";font-size:14px !important;}}}}}.mapbox-container-image{border:5px solid transparent;border-radius:50%;border-top:5px solid #8dca3f;border-bottom:5px solid #8dca3f;width:80px;height:80px;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite;margin-left:auto;margin-right:auto;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{min-height:unset;width:40px;height:40px;margin-left:auto;margin-right:auto;}}@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}.mapbox-container{position:relative;flex:1;min-height:391px;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{min-height:unset;}}.mapbox-mobile-overlay{@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{position:absolute;left:-16px;width:100vw;height:100%;background:rgba(0,0,0,0.5);z-index:4;justify-content:center;align-items:center;display:flex;font-size:1.2rem;color:white;user-select:none;}}.mapboxgl-wrapper{height:437px;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{height:256px;margin:0 -16px 16px -16px;}}.mapboxgl-map{flex:1;min-height:391px;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{min-height:unset;}.mapboxgl-ctrl-top-right{right:unset;left:8px;.mapboxgl-ctrl{float:left;}}}.map-controls{position:absolute;top:10px;right:10px;background-color:",(function(e){return e.theme.colors.paper}),";width:120px;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{margin:0 -16px;}ul{margin:0px;padding:0px;list-style-type:none;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{display:flex;flex-wrap:wrap;}}li:first-of-type{display:flex;align-items:center;padding:2px 8px;> span{font-size:20px;margin-right:8px;}@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{flex:0 0 calc(100% + 16px);}}li{display:block;> label{cursor:pointer;padding:2px 8px;display:flex;align-items:center;> div{margin-right:8px;display:inline-block;}}@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{flex-basis:50%;}}@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{position:relative;width:100%;top:0;right:0;}}.destination-list{position:absolute;right:0;top:0;@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{position:relative;}.scroll-box{max-height:330px;overflow-y:auto;&::-webkit-scrollbar{width:0.5em;}&::-webkit-scrollbar-track{}&::-webkit-scrollbar-thumb{background-color:darkgrey;}@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{display:flex;overflow-x:auto;margin-top:0.5rem;}}.destination-item{background:white;margin:0 0.5rem 0.5rem;padding:1rem;width:200px;border:1px;display:block;cursor:pointer;box-shadow:0 0 6px 0px rgba(0,0,0,0.2);text-align:left;outline:none;&.active{background:",(function(e){return e.theme.colors.primary}),";color:#fff;}@media ",(function(e){return e.theme.mediaQueries.atLeastPhone}),"{display:inline-flex;flex-direction:column;min-width:200px;border:1px solid rgba(0,0,0,0.1);}}.distance-info{font-size:0.8rem;margin-top:0.5rem;font-weight:300;}.destination-modes{display:flex;align-items:center;justify-content:center;margin:0.5rem;button{background:#fff;border:0;padding:7px 15px;outline:none;cursor:pointer;box-shadow:0 0 6px 0px rgba(0,0,0,0.2);display:block;width:100%;letter-spacing:1px;text-transform:uppercase;font-family:MuseoSansCyrl,Helvetica Neue,Roboto,sans-serif;&.active{background:",(function(e){return e.theme.colors.primary}),";color:#fff;font-weight:bold;}}}}.map-static{height:391px;max-height:391px;flex:initial !important;position:relative;img{max-width:100%;object-fit:cover;object-position:center;height:100%;width:100%;}}"),v=n("Jy6O"),b=Object(c.createContext)(),w=n("erxC"),x=d.a.createElement,y=function(e){var t=e.list,n=e.onChange,i=Object(c.useState)(null),o=i[0],a=i[1],r=Object(c.useContext)(b).selectedSelector;return Object(c.useEffect)((function(){a(r)}),[r]),x(w.a,{className:"carousel-select",handle:"arrow",offscreenLimit:5,light:!0,thickness:60},t.map((function(e,i){var r=e.label,l=e.value;return x(v.Button,{className:o===l?"selected":"",onClick:function(){return a(t[e=i].value),void n(e);var e},key:l},r)})))},O=d.a.createElement;function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L="https://www.realestate.com.kh",P=[],C=function(e){var t,n,i,l,u,m=e.nearbyPlaces,g=Object(s.a)(e,["nearbyPlaces"]),v=(((g||null).aside||{}).listing||{addressDisplay:!1}).addressDisplay,w="undefined"===typeof(null===g||void 0===g?void 0:g.aside)||"undefined"===typeof(null===g||void 0===g||null===(t=g.aside)||void 0===t?void 0:t.listing)?null:null===g||void 0===g||null===(n=g.aside)||void 0===n||null===(i=n.listing)||void 0===i?void 0:i.id;if(!w)return null;if(!m||null===m||void 0===m||!m.defaultCenter||null===m||void 0===m||!m.defaultCenter[0]||null===m||void 0===m||!m.defaultCenter[1])return O(h,null,O("h2",null,null!==g&&void 0!==g&&g.headline?null===g||void 0===g?void 0:g.headline:null===m||void 0===m?void 0:m.headline),O("p",null,"No default center coordinates for the map."));var x=Object(c.useState)(null),j=x[0],C=x[1],N=Object(c.useState)(null),S=N[0],E=N[1],I=Object(c.useState)([]),T=I[0],Q=I[1],z=Object(c.useState)(null),D=z[0],B=z[1],M=Object(c.useState)(-1),_=M[0],G=M[1],A=Object(c.useState)("WALKING"),V=A[0],W=A[1],R=Object(c.useState)(null),J=R[0],K=R[1],H=Object(c.useState)(null),F=H[0],q=H[1],U=Object(c.useState)(!1),X=U[0],Y=U[1],Z=Object(c.useState)(!0),$=Z[0],ee=Z[1],te=Object(c.useState)(null),ne=te[0],ie=te[1],oe=Object(c.useState)(!0),ae=oe[0],re=oe[1],le=Object(c.useState)(),se=le[0],ce=le[1],de=Object(c.useState)(!1),ue=de[0],pe=de[1],me=null===m||void 0===m||null===(l=m.places)||void 0===l||null===(u=l.checkboxes)||void 0===u?void 0:u.map((function(e){return k(k({},e),{},{checked:S?S.includes(null===e||void 0===e?void 0:e.value):""})})),fe=me.filter((function(e){return e.checked})),ge=Object(r.a)(fe),he=ge[0],ve=ge.slice(1),be=he?{displayLabel:"".concat(he.label).concat(ve.length?" +".concat(ve.length):""),displayIconCode:he.iconCode}:m.places,we="",xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$&&ee(!1),X||(E([e]),Y(!0),t&&C(me[e].value))},ye=function(e,t,n,i){if(e.geometry&&e.geometry.location&&window&&window.map){var o,a=new window.google.maps.Marker({map:n,position:e.geometry.location,title:e.name,icon:{url:(o=t.icon,"".concat(L,"/static/img/icons/").concat(o,".svg")),scaledSize:new window.google.maps.Size(32,32),origin:new window.google.maps.Point(0,0),anchor:new window.google.maps.Point(0,0)},index:i});P.push(a),ne||ie(new window.google.maps.InfoWindow),we.extend(e.geometry.location)}},Oe=function(){var e=Object(a.a)(o.a.mark((function e(t,n,i){var a,r,l,s,c,d,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F&&F.setMap(null),G(-1),K(new window.google.maps.DirectionsService),q(new window.google.maps.DirectionsRenderer({map:D,preserveViewport:!0})),a=[],e.next=7,p()("".concat(L,"/api/listing-places/?listing_id=").concat(w,"&location_type=").concat(t.value,"&page_size=100&platform=website")).then((function(e){return e.json()})).then((function(e){e.count>0&&(a=null===e||void 0===e?void 0:e.results)}));case 7:if(a.length>0){for(r=[],we=new window.google.maps.LatLngBounds(n),l=[],s=0;s<a.length;s++)c=a[s],d=new window.google.maps.LatLng(c.latitude,c.longitude),r.includes(c.title)||(r.push(c.title),a[s].lat=c.latitude,a[s].lng=c.longitude,u={name:c.title,geometry:{location:d}},l.push({title:c.title,lat:c.latitude,lng:c.longitude,id:c.id}),ye(u,t,i,s));Q(l),i.fitBounds(we),i.panToBounds(we)}else Q([]);setTimeout((function(){Y(!1)}),1e3);case 9:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),je=function(e){var t={lat:m.defaultCenter[1]||null,lng:m.defaultCenter[0]||null},n=new window.google.maps.LatLng(t.lat,t.lng),i="";if(window.map&&"object"!==typeof window.map||""===document.getElementById(e).innerHTML?(i=new window.google.maps.Map(document.getElementById(e),{center:n,zoom:14,zoomControlOptions:{position:window.google.maps.ControlPosition.LEFT_BOTTOM},streetViewControlOptions:{position:window.google.maps.ControlPosition.LEFT_BOTTOM},fullscreenControl:!1}),window.map=i):(i=window.map,window.google.maps.event.trigger(i,"resize")),B(i),S&&S.length>0){for(;P.length;)P.pop().setMap(null);S.forEach((function(e){var t;Oe(null===m||void 0===m||null===(t=m.places)||void 0===t?void 0:t.checkboxes[e],n,i)}))}},ke=function(e){var t={lat:(null===m||void 0===m?void 0:m.defaultCenter[1])||null,lng:(null===m||void 0===m?void 0:m.defaultCenter[0])||null},n=T[e];p()("".concat(L,"/api/listing-places/").concat(T[e].id,"/?platform=website&include_distance=True")).then((function(e){return e.json()})).then((function(e){Q((function(t){return t.map((function(t){return t.id===e.id?k(k({},t),{},{destination:{distance:e.distance[V.toLowerCase()][0].elements[0].distance.text,duration:e.distance[V.toLowerCase()][0].elements[0].duration.text}}):t}))}))}));var i={origin:t,destination:{lat:n.lat,lng:n.lng},travelMode:V};"locality"!==v&&J.route(i,(function(e,t){"OK"===t&&F.setDirections(e)})),G(e),document.getElementById("destinations-scroller").scrollTop=document.getElementById("destination-".concat(e)).offsetTop-50},Le=function(){var e=document.getElementById("googleMaps");if(!e){var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyDaT-gLNB4TCApWbrP0tArSDe3UgI8oet4","&libraries=geometry,places,distancematrix&v=weekly"),t.id="googleMaps",document.body.appendChild(t),t.onload=function(){je("map-display")}}e&&je("map-display")},Pe=function(){var e=Object(a.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=5;break}return e.next=3,p()("".concat(L,"/api/listing/").concat(w,"/map-image/")).then((function(e){return e.json()})).then((function(e){ce(null===e||void 0===e?void 0:e.map_image_url)}));case 3:e.next=7;break;case 5:ee(!1),Le();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){pe(!0)}),[]),Object(c.useEffect)((function(){$?Pe():(ue&&Le(),ae&&(setTimeout((function(){W("DRIVING")}),1500),re(!1)))}),[S,V]),Object(c.useEffect)((function(){P.forEach((function(e){e.addListener("click",(function(){var t;ne.setContent((null===e||void 0===e?void 0:e.title)||""),ne.open(null===(t=window)||void 0===t?void 0:t.map,e),ke(null===e||void 0===e?void 0:e.index)}))}))}),[T]),O(d.a.Fragment,null,O(h,{id:"map"},O("h2",null,null!==g&&void 0!==g&&g.headline?null===g||void 0===g?void 0:g.headline:null===m||void 0===m?void 0:m.headline),O("div",{className:"content"},X&&O("div",{className:"mapbox-spinner-container"},O("div",{className:"mapbox-container-image"})),O("div",{className:"filters"},O("div",{className:"selectors"},O(b.Provider,{value:{selectedSelector:j}},O(y,{displayValue:be,list:me,onChange:xe})))),$?O("div",{className:"map-static",onClick:function(){return xe(0,!0)}},se?O(f.a,{src:se,alt:null!==g&&void 0!==g&&g.headline?null===g||void 0===g?void 0:g.headline:null===m||void 0===m?void 0:m.headline,layout:"fill"}):O("div",{className:"mapbox-spinner-container"},O("div",{className:"mapbox-container-image"}))):O("div",{className:"map-container"},O("div",{id:"map-display",style:{height:"400px",width:"100%"}}),O("div",{className:"destination-list"},O("div",{className:"destination-modes"},O("button",{type:"button",onClick:function(){return W("DRIVING")},className:"DRIVING"===V?"active":""},"Driving"),O("button",{type:"button",onClick:function(){return W("WALKING")},className:"WALKING"===V?"active":""},"Walking")),O("div",{className:"scroll-box destinations",id:"destinations-scroller"},S&&0===T.length&&O("div",{className:"destination-item"},"No nearby destinations found."),T&&T.length>0&&T.map((function(e,t){var n,i;return O("button",{key:t,className:"destination-item ".concat(_===t?"active":""),onClick:function(){return ke(t)},type:"button","data-index":t,id:"destination-".concat(t)},O("div",{style:{fontWeight:"bold"}},null===e||void 0===e?void 0:e.title),O("div",{className:"distance-info"},(null===e||void 0===e?void 0:e.destination)&&"".concat(null===e||void 0===e||null===(n=e.destination)||void 0===n?void 0:n.distance,"/").concat(null===e||void 0===e||null===(i=e.destination)||void 0===i?void 0:i.duration)))}))))))))}}}]);